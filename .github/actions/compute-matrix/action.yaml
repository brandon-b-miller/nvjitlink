name: Compute matrix

outputs:
  MATRIX:
    value: ${{ steps.compute-matrix.outputs.MATRIX }}

runs:
  using: composite
  steps:
    - name: Compute matrix
      id: compute-matrix
      shell: bash
      run: |
        set -eo pipefail

        export MATRIX="
        - { CUDA_VER: '12.0.1', ARCH: 'amd64', PY_VER: '3.9', LINUX_VER: 'centos7' }
        - { CUDA_VER: '12.0.1', ARCH: 'amd64', PY_VER: '3.10', LINUX_VER: 'centos7' }
        - { CUDA_VER: '12.0.1', ARCH: 'arm64', PY_VER: '3.9', LINUX_VER: 'rockylinux8' }
        - { CUDA_VER: '12.0.1', ARCH: 'arm64', PY_VER: '3.10', LINUX_VER: 'rockylinux8' }
        "

        echo "MATRIX=$(
          yq -n -o json 'env(MATRIX)' | \
          jq -c '.' \
        )" | tee --append "${GITHUB_OUTPUT}"
